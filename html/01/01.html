<!DOCTYPE html>
<html>
<head>
    <title>01. Basic websocket connection</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable = no">

    <link rel="stylesheet" href="simple.css"/>

    <script src="../js/socket.io.js"></script>
    <script type="text/javascript">

        var cns, ID;

        function log(m) {
            if (!cns) cns = document.getElementById('console');
            var d = new Date();
            var t = d.getHours() + ":" + d.getMinutes() + ":" + d.getSeconds() + ":" + d.getMilliseconds()
            cns.innerHTML += "[" + ID + "] " + t + "<br>" + m + "<br><br>";
        }

        window.onload = function () {
            ID = Math.random() * 999 | 1;
            log("New client connected");

            document.addEventListener('mouseup', function () {
                log("local click " + ID);
                socket.emit('touch', { message: "remote click " + ID });
            });

            document.addEventListener('touchend', function () {
                log("local tap " + ID);
                socket.emit('touch', { message: "remote tap " + ID });
            });


            var serverUrl = 'http://ec2-54-218-0-72.us-west-2.compute.amazonaws.com:8123';

            log("Connecting to server");

            var socket = io.connect(serverUrl);

            console.log(socket);

            socket.on('touch', function (data) {
                log(data.message);

            });
        }

    </script>

</head>
<body>
<div id="console"></div>

<script>
    if (location.host == "localhost") {
        document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>');
    }
</script>

</body>
</html>